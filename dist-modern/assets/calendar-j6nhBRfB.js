import{m as l,M as u}from"./main-DjhHGxoE.js";document.addEventListener("alpine:init",()=>{l.data("calendarComponent",()=>({sidebarVisible:!1,currentView:"month",selectedDate:null,selectedDay:null,currentDate:new Date,miniCalendarDate:new Date,visibleTypes:["event","meeting","task","reminder","deadline"],events:[],hours:["6:00 AM","7:00 AM","8:00 AM","9:00 AM","10:00 AM","11:00 AM","12:00 PM","1:00 PM","2:00 PM","3:00 PM","4:00 PM","5:00 PM","6:00 PM","7:00 PM","8:00 PM","9:00 PM","10:00 PM"],init(){this.loadEvents(),this.selectedDate=new Date,this.selectedDay=new Date().toISOString().split("T")[0],this.currentDate=new Date,this.miniCalendarDate=new Date},async loadEvents(){try{const t=await(await fetch("/dashboard/api/events/")).json();t.success?this.events=t.events.map(n=>({...n,dateObj:new Date(n.date)})):(console.error("Etkinlikler y√ºklenirken hata:",t.error),this.events=[])}catch(e){console.error("API hatasƒ±:",e),this.events=[]}},formatTime(e){const[t,n]=e.split(":"),a=t%12||12,r=t>=12?"PM":"AM";return`${a}:${n} ${r}`},get currentMonthYear(){return this.miniCalendarDate.toLocaleDateString("en-US",{month:"long",year:"numeric"})},get currentPeriodTitle(){if(this.currentView==="month")return this.currentDate.toLocaleDateString("en-US",{month:"long",year:"numeric"});if(this.currentView==="week"){const e=new Date(this.currentDate);e.setDate(this.currentDate.getDate()-this.currentDate.getDay());const t=new Date(e);return t.setDate(e.getDate()+6),`${e.toLocaleDateString("en-US",{month:"short",day:"numeric"})} - ${t.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}`}else return this.currentDate.toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric",year:"numeric"})},get selectedDayTitle(){return this.selectedDay?new Date(this.selectedDay).toLocaleDateString("en-US",{weekday:"long"}):""},get selectedDayDate(){return this.selectedDay?new Date(this.selectedDay).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"}):""},get miniCalendarDays(){const e=this.miniCalendarDate.getFullYear(),t=this.miniCalendarDate.getMonth(),n=new Date(e,t,1),a=new Date(n);a.setDate(a.getDate()-n.getDay());const r=[];for(let s=0;s<42;s++){const i=new Date(a);i.setDate(a.getDate()+s);const o=i.toISOString().split("T")[0],c=this.events.some(d=>d.date===o);r.push({date:o,day:i.getDate(),isToday:this.isToday(i),isOtherMonth:i.getMonth()!==t,isSelected:o===this.selectedDay,hasEvents:c})}return r},get calendarDays(){const e=this.currentDate.getFullYear(),t=this.currentDate.getMonth(),n=new Date(e,t,1),a=new Date(n);a.setDate(a.getDate()-n.getDay());const r=[];for(let s=0;s<42;s++){const i=new Date(a);i.setDate(a.getDate()+s);const o=i.toISOString().split("T")[0],c=this.getEventsForDate(o).filter(d=>this.visibleTypes.includes(d.type));r.push({date:o,day:i.getDate(),isToday:this.isToday(i),isOtherMonth:i.getMonth()!==t,isSelected:o===this.selectedDay,events:c})}return r},get weekDays(){const e=new Date(this.currentDate);e.setDate(this.currentDate.getDate()-this.currentDate.getDay());const t=[];for(let n=0;n<7;n++){const a=new Date(e);a.setDate(e.getDate()+n),t.push({date:a.toISOString().split("T")[0],dayName:a.toLocaleDateString("en-US",{weekday:"short"}),dayNumber:a.getDate(),isToday:this.isToday(a)})}return t},get upcomingEvents(){const e=new Date;return this.events.filter(t=>this.visibleTypes.includes(t.type)?t.dateObj>=e:!1).sort((t,n)=>t.dateObj-n.dateObj).slice(0,8)},previousMonth(){const e=new Date(this.miniCalendarDate);e.setMonth(e.getMonth()-1),this.miniCalendarDate=e},nextMonth(){const e=new Date(this.miniCalendarDate);e.setMonth(e.getMonth()+1),this.miniCalendarDate=e},previousPeriod(){const e=new Date(this.currentDate);this.currentView==="month"?e.setMonth(e.getMonth()-1):this.currentView==="week"?e.setDate(e.getDate()-7):e.setDate(e.getDate()-1),this.currentDate=e},nextPeriod(){const e=new Date(this.currentDate);this.currentView==="month"?e.setMonth(e.getMonth()+1):this.currentView==="week"?e.setDate(e.getDate()+7):e.setDate(e.getDate()+1),this.currentDate=e},goToToday(){this.currentDate=new Date,this.miniCalendarDate=new Date,this.selectedDay=new Date().toISOString().split("T")[0]},switchView(e){this.currentView=e,e==="day"&&!this.selectedDay&&(this.selectedDay=new Date().toISOString().split("T")[0])},selectDate(e){this.selectedDay=e,this.selectedDate=new Date(e),this.currentView==="day"&&(this.currentDate=new Date(e))},selectDay(e){this.selectDate(e.date)},isToday(e){const t=new Date;return e.toDateString()===t.toDateString()},isCurrentHour(e){const n=new Date().getHours(),a=parseInt(e.split(":")[0]),r=e.includes("AM");let s=a;return!r&&a!==12?s+=12:r&&a===12&&(s=0),s===n},getEventsForDate(e){return this.events.filter(t=>t.date===e)},getEventsForDateTime(e,t){return this.events.filter(n=>n.date!==e?!1:this.eventMatchesHour(n,t))},eventMatchesHour(e,t){const n=parseInt(e.time.split(":")[0]),a=parseInt(t.split(":")[0]),r=t.includes("AM");let s=a;return!r&&a!==12?s+=12:r&&a===12&&(s=0),n===s},getDayEventCount(e){return this.getEventsForDate(e).length},getCategoryCount(e){return this.events.filter(t=>t.type===e).length},getCategoryColor(e){return{event:"var(--bs-primary)",meeting:"var(--bs-success)",task:"var(--bs-warning)",reminder:"#8b5cf6",deadline:"var(--bs-danger)"}[e]||"var(--bs-secondary)"},getBadgeClass(e){return{event:"bg-primary",meeting:"bg-success",task:"bg-warning text-dark",reminder:"text-white",deadline:"bg-danger"}[e]||"bg-secondary"},getAlertClass(e){return{event:"alert-primary",meeting:"alert-success",task:"alert-warning",reminder:"alert-info",deadline:"alert-danger"}[e]||"alert-secondary"},viewEvent(e){this.showNotification(`Viewing event: ${e.title}`,"info")},addEvent(){new u(document.getElementById("addEventModal")).show()},addEventForDay(e){this.selectDay(e);const t=l.$data(document.querySelector('[x-data*="addEventModal"]'));t&&(t.eventData.date=e.date),this.addEvent()},addEventAtTime(e,t){this.selectDate(e);const n=l.$data(document.querySelector('[x-data*="addEventModal"]'));if(n){n.eventData.date=e;const a=parseInt(t.split(":")[0]),r=t.includes("AM");let s=a;!r&&a!==12?s+=12:r&&a===12&&(s=0),n.eventData.time=`${s.toString().padStart(2,"0")}:00`}this.addEvent()},showMoreEvents(e){this.selectDay(e),this.showNotification(`Showing all events for ${e.date}`,"info")},exportCalendar(){this.showNotification("Calendar export would start here","info")},toggleSidebar(){this.sidebarVisible=!this.sidebarVisible},showNotification(e,t="info"){typeof Swal<"u"?Swal.fire({title:e,icon:t==="success"?"success":t==="error"?"error":"info",toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3}):alert(e)}})),l.data("addEventModal",()=>({eventData:{title:"",type:"event",date:"",time:"",description:"",duration:"60",recurring:!1,recurrence:"weekly",priority:"medium",reminders:["15"],attendees:"",location:""},priorityOptions:[{value:"low",label:"Low Priority",color:"var(--bs-success)"},{value:"medium",label:"Medium Priority",color:"var(--bs-warning)"},{value:"high",label:"High Priority",color:"var(--bs-danger)"}],reminderOptions:[{value:"0",label:"At time of event"},{value:"5",label:"5 minutes before"},{value:"15",label:"15 minutes before"},{value:"30",label:"30 minutes before"},{value:"60",label:"1 hour before"},{value:"1440",label:"1 day before"}],init(){this.eventData.date=new Date().toISOString().split("T")[0],this.eventData.time="09:00"},async submitEvent(){if(!this.eventData.title.trim()){this.showValidationError("L√ºtfen etkinlik ba≈ülƒ±ƒüƒ± girin");return}if(!this.eventData.date){this.showValidationError("L√ºtfen bir tarih se√ßin");return}if(!this.eventData.time){this.showValidationError("L√ºtfen bir saat se√ßin");return}try{const e=document.querySelector("[name=csrfmiddlewaretoken]")?.value||document.querySelector('meta[name="csrf-token"]')?.getAttribute("content"),n=await(await fetch("/dashboard/api/events/create/",{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":e},body:JSON.stringify(this.eventData)})).json();if(n.success){const a={...this.eventData,formattedDate:new Date(this.eventData.date).toLocaleDateString("tr-TR",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),formattedTime:new Date(`2000-01-01T${this.eventData.time}`).toLocaleTimeString("tr-TR",{hour:"numeric",minute:"2-digit"})};typeof Swal<"u"?Swal.fire({title:"Etkinlik Ba≈üarƒ±yla Olu≈üturuldu!",html:`
                <div class="text-start">
                  <p><strong>üìÖ Etkinlik:</strong> ${a.title}</p>
                  <p><strong>üìã T√ºr:</strong> ${this.getTypeDisplayName(a.type)}</p>
                  <p><strong>üìÜ Tarih:</strong> ${a.formattedDate}</p>
                  <p><strong>üïê Saat:</strong> ${a.formattedTime}</p>
                  ${a.description?`<p><strong>üìù A√ßƒ±klama:</strong> ${a.description}</p>`:""}
                  ${a.location?`<p><strong>üìç Konum:</strong> ${a.location}</p>`:""}
                  <p><strong>‚è±Ô∏è S√ºre:</strong> ${this.getDurationLabel(a.duration)}</p>
                </div>
              `,icon:"success",confirmButtonText:"Harika!",confirmButtonColor:"var(--bs-primary)"}):alert(`Etkinlik "${this.eventData.title}" ba≈üarƒ±yla olu≈üturuldu!`);const r=l.$data(document.querySelector('[x-data*="calendarComponent"]'));r&&await r.loadEvents(),this.closeModal()}else this.showValidationError(n.error||"Etkinlik olu≈üturulurken bir hata olu≈ütu")}catch(e){console.error("Etkinlik olu≈üturma hatasƒ±:",e),this.showValidationError("Sunucu ile ileti≈üim kurulurken bir hata olu≈ütu")}},getTypeDisplayName(e){return{event:"Etkinlik",meeting:"Toplantƒ±",task:"G√∂rev",reminder:"Hatƒ±rlatƒ±cƒ±",deadline:"Son Tarih"}[e]||e},getDurationLabel(e){const t=Math.floor(e/60),n=e%60;return e==480?"All day":t===0?`${n} minutes`:n===0?`${t} hour${t>1?"s":""}`:`${t}h ${n}m`},showValidationError(e){typeof Swal<"u"?Swal.fire({title:"Validation Error",text:e,icon:"error",confirmButtonText:"OK",confirmButtonColor:"var(--bs-danger)"}):alert(e)},closeModal(){const e=document.getElementById("addEventModal");if(e){const t=u.getInstance(e);t&&t.hide()}this.resetForm()},resetForm(){this.eventData={title:"",type:"event",date:new Date().toISOString().split("T")[0],time:"09:00",description:"",duration:"60",recurring:!1,recurrence:"weekly",priority:"medium",reminders:["15"],attendees:"",location:""}},getTypeColor(e){return{event:"var(--bs-primary)",meeting:"var(--bs-success)",task:"var(--bs-warning)",reminder:"#8b5cf6",deadline:"var(--bs-danger)"}[e]||"var(--bs-secondary)"}})),l.data("searchComponent",()=>({query:"",results:[],search(){this.query.length>2?this.results=[{title:"Team Meeting",url:"/calendar.html",type:"Event"},{title:"Calendar Settings",url:"/settings.html",type:"Page"},{title:"Project Timeline",url:"/calendar.html",type:"Event"}].filter(e=>e.title.toLowerCase().includes(this.query.toLowerCase())):this.results=[]}})),l.data("themeSwitch",()=>({currentTheme:"light",init(){this.currentTheme=localStorage.getItem("theme")||"light",document.documentElement.setAttribute("data-bs-theme",this.currentTheme)},toggle(){this.currentTheme=this.currentTheme==="light"?"dark":"light",document.documentElement.setAttribute("data-bs-theme",this.currentTheme),localStorage.setItem("theme",this.currentTheme)}}))});
